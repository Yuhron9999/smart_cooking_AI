<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test Smart Cooking AI APIs</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-100">
    <div class="container mx-auto px-4 py-8">
      <h1 class="text-3xl font-bold text-center mb-8 text-gray-800">
        üß™ Test Smart Cooking AI APIs
      </h1>

      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- AI Chat Test -->
        <div class="bg-white rounded-lg shadow-lg p-6">
          <h2 class="text-xl font-semibold mb-4 text-blue-600">üí¨ AI Chat</h2>
          <textarea
            id="chatMessage"
            class="w-full p-3 border rounded-lg mb-3"
            placeholder="Nh·∫≠p c√¢u h·ªèi cho AI..."
          ></textarea>
          <button
            onclick="testChat()"
            class="w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600"
          >
            Test Chat
          </button>
          <div
            id="chatResult"
            class="mt-4 p-3 bg-gray-50 rounded-lg hidden"
          ></div>
        </div>

        <!-- Recipe Generation Test -->
        <div class="bg-white rounded-lg shadow-lg p-6">
          <h2 class="text-xl font-semibold mb-4 text-green-600">
            üìù T·∫°o C√¥ng Th·ª©c
          </h2>
          <textarea
            id="recipeIngredients"
            class="w-full p-3 border rounded-lg mb-3"
            placeholder="Nh·∫≠p nguy√™n li·ªáu (c√°ch nhau b·ªüi d·∫•u ph·∫©y)..."
          ></textarea>
          <button
            onclick="testRecipeGeneration()"
            class="w-full bg-green-500 text-white py-2 rounded-lg hover:bg-green-600"
          >
            T·∫°o C√¥ng Th·ª©c
          </button>
          <div
            id="recipeResult"
            class="mt-4 p-3 bg-gray-50 rounded-lg hidden"
          ></div>
        </div>

        <!-- Ingredient Suggestions Test -->
        <div class="bg-white rounded-lg shadow-lg p-6">
          <h2 class="text-xl font-semibold mb-4 text-orange-600">
            ü•ï G·ª£i √ù Nguy√™n Li·ªáu
          </h2>
          <input
            id="dishName"
            class="w-full p-3 border rounded-lg mb-3"
            placeholder="Nh·∫≠p t√™n m√≥n ƒÉn..."
          />
          <button
            onclick="testIngredientSuggestions()"
            class="w-full bg-orange-500 text-white py-2 rounded-lg hover:bg-orange-600"
          >
            G·ª£i √ù Nguy√™n Li·ªáu
          </button>
          <div
            id="ingredientResult"
            class="mt-4 p-3 bg-gray-50 rounded-lg hidden"
          ></div>
        </div>

        <!-- Learning Path Test -->
        <div class="bg-white rounded-lg shadow-lg p-6">
          <h2 class="text-xl font-semibold mb-4 text-purple-600">
            üìö L·ªô Tr√¨nh H·ªçc
          </h2>
          <label for="skillLevel" class="block mb-1 font-medium text-gray-700">Ch·ªçn tr√¨nh ƒë·ªô k·ªπ nƒÉng</label>
          <select id="skillLevel" class="w-full p-3 border rounded-lg mb-3" title="Ch·ªçn tr√¨nh ƒë·ªô k·ªπ nƒÉng">
            <option value="beginner">Ng∆∞·ªùi m·ªõi b·∫Øt ƒë·∫ßu</option>
            <option value="intermediate">Trung c·∫•p</option>
            <option value="advanced">N√¢ng cao</option>
          </select>
          <button
            onclick="testLearningPath()"
            class="w-full bg-purple-500 text-white py-2 rounded-lg hover:bg-purple-600"
          >
            T·∫°o L·ªô Tr√¨nh
          </button>
          <div
            id="learningResult"
            class="mt-4 p-3 bg-gray-50 rounded-lg hidden"
          ></div>
        </div>

        <!-- Nutrition Analysis Test -->
        <div class="bg-white rounded-lg shadow-lg p-6">
          <h2 class="text-xl font-semibold mb-4 text-red-600">
            üçé Ph√¢n T√≠ch Dinh D∆∞·ª°ng
          </h2>
          <textarea
            id="nutritionIngredients"
            class="w-full p-3 border rounded-lg mb-3"
            placeholder="Nh·∫≠p nguy√™n li·ªáu (c√°ch nhau b·ªüi d·∫•u ph·∫©y)..."
          ></textarea>
          <button
            onclick="testNutritionAnalysis()"
            class="w-full bg-red-500 text-white py-2 rounded-lg hover:bg-red-600"
          >
            Ph√¢n T√≠ch Dinh D∆∞·ª°ng
          </button>
          <div
            id="nutritionResult"
            class="mt-4 p-3 bg-gray-50 rounded-lg hidden"
          ></div>
        </div>

        <!-- AI Service Health Check -->
        <div class="bg-white rounded-lg shadow-lg p-6">
          <h2 class="text-xl font-semibold mb-4 text-indigo-600">
            üîß Health Check
          </h2>
          <button
            onclick="testHealthCheck()"
            class="w-full bg-indigo-500 text-white py-2 rounded-lg hover:bg-indigo-600 mb-3"
          >
            Ki·ªÉm Tra AI Service
          </button>
          <button
            onclick="testBackendHealth()"
            class="w-full bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600"
          >
            Ki·ªÉm Tra Backend
          </button>
          <div
            id="healthResult"
            class="mt-4 p-3 bg-gray-50 rounded-lg hidden"
          ></div>
        </div>
      </div>

      <!-- Global Results -->
      <div id="globalResults" class="mt-8 hidden">
        <h2 class="text-2xl font-semibold mb-4">üìä K·∫øt Qu·∫£ Test</h2>
        <div class="bg-white rounded-lg shadow-lg p-6">
          <pre id="globalResultsContent" class="text-sm overflow-x-auto"></pre>
        </div>
      </div>
    </div>

    <script>
      // Base API URL
      const API_BASE = "http://localhost:8080/api";

      // Utility function to display results
      function displayResult(elementId, data, isError = false) {
        const element = document.getElementById(elementId);
        element.classList.remove("hidden");
        element.className = `mt-4 p-3 rounded-lg ${isError ? "bg-red-50 text-red-800" : "bg-gray-50"}`;
        element.innerHTML = `<pre class="text-sm overflow-x-auto">${JSON.stringify(data, null, 2)}</pre>`;
      }

      // Test AI Chat
      async function testChat() {
        const message = document.getElementById("chatMessage").value;
        if (!message.trim()) {
          alert("Vui l√≤ng nh·∫≠p c√¢u h·ªèi");
          return;
        }

        try {
          const response = await fetch(`${API_BASE}/ai/chat`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              message: message,
              language: "vi",
            }),
          });
          const data = await response.json();
          displayResult("chatResult", data);
        } catch (error) {
          displayResult("chatResult", { error: error.message }, true);
        }
      }

      // Test Recipe Generation
      async function testRecipeGeneration() {
        const ingredients = document.getElementById("recipeIngredients").value;
        if (!ingredients.trim()) {
          alert("Vui l√≤ng nh·∫≠p nguy√™n li·ªáu");
          return;
        }

        try {
          const response = await fetch(`${API_BASE}/ai/generate-recipe`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              ingredients: ingredients.split(",").map((i) => i.trim()),
              preferences: {},
              language: "vi",
            }),
          });
          const data = await response.json();
          displayResult("recipeResult", data);
        } catch (error) {
          displayResult("recipeResult", { error: error.message }, true);
        }
      }

      // Test Ingredient Suggestions
      async function testIngredientSuggestions() {
        const dishName = document.getElementById("dishName").value;
        if (!dishName.trim()) {
          alert("Vui l√≤ng nh·∫≠p t√™n m√≥n ƒÉn");
          return;
        }

        try {
          const response = await fetch(
            `${API_BASE}/ai/ingredient-suggestions`,
            {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({
                dish_name: dishName,
                cuisine_type: "vietnamese",
              }),
            }
          );
          const data = await response.json();
          displayResult("ingredientResult", data);
        } catch (error) {
          displayResult("ingredientResult", { error: error.message }, true);
        }
      }

      // Test Learning Path
      async function testLearningPath() {
        const skillLevel = document.getElementById("skillLevel").value;

        try {
          const response = await fetch(`${API_BASE}/ai/learning-path`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              skill_level: skillLevel,
              cuisine_preference: "vietnamese",
              available_time: 30,
            }),
          });
          const data = await response.json();
          displayResult("learningResult", data);
        } catch (error) {
          displayResult("learningResult", { error: error.message }, true);
        }
      }

      // Test Nutrition Analysis
      async function testNutritionAnalysis() {
        const ingredients = document.getElementById(
          "nutritionIngredients"
        ).value;
        if (!ingredients.trim()) {
          alert("Vui l√≤ng nh·∫≠p nguy√™n li·ªáu");
          return;
        }

        try {
          const response = await fetch(`${API_BASE}/ai/nutrition-analysis`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              ingredients: ingredients.split(",").map((i) => i.trim()),
              servings: 4,
            }),
          });
          const data = await response.json();
          displayResult("nutritionResult", data);
        } catch (error) {
          displayResult("nutritionResult", { error: error.message }, true);
        }
      }

      // Test AI Service Health
      async function testHealthCheck() {
        try {
          const response = await fetch(`${API_BASE}/ai/health`);
          const data = await response.json();
          displayResult("healthResult", data);
        } catch (error) {
          displayResult("healthResult", { error: error.message }, true);
        }
      }

      // Test Backend Health
      async function testBackendHealth() {
        try {
          const response = await fetch(`${API_BASE}/health`);
          const text = await response.text();
          displayResult("healthResult", {
            status: "Backend is running",
            response: text,
          });
        } catch (error) {
          displayResult("healthResult", { error: error.message }, true);
        }
      }

      // Initial load - test backend connectivity
      window.onload = function () {
        setTimeout(testBackendHealth, 1000);
      };
    </script>
  </body>
</html>
