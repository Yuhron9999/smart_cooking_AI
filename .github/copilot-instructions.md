# ğŸŒŸ SMART COOKING AI - Há»† THá»NG Há»ŒC & Táº O CÃ”NG THá»¨C Náº¤U Ä‚N TÃCH Há»¢P AI + VOICE ASSISTANT

## ğŸ“‹ Tá»•ng quan Dá»± Ã¡n

ÄÃ¢y lÃ  má»™t **há»‡ thá»‘ng fullstack hoÃ n chá»‰nh** cho viá»‡c há»c vÃ  táº¡o cÃ´ng thá»©c náº¥u Äƒn thÃ´ng minh vá»›i tÃ­ch há»£p AI, bao gá»“m:

### ğŸ—ï¸ Kiáº¿n trÃºc Há»‡ thá»‘ng

  * **Backend API**: **Spring Boot** (cá»•ng 8080) - Core business logic, authentication, data management
  * **AI Service**: **FastAPI** (cá»•ng 8001) - Gemini integration, Voice processing (STT/TTS)
  * **Web Frontend**: **Next.js** (cá»•ng 3000) - Responsive web app vá»›i Ä‘a ngÃ´n ngá»¯
  * **Mobile App**: **Flutter** - Cross-platform mobile vá»›i voice assistant
  * **Database**: **MySQL** + **Redis** (cache) + **Firebase Storage** (media)
  * **Analytics**: **Looker Studio** integration cho data insights
  * **Authentication**: **Google OAuth2** across all platforms Ä‘Ã£ thÃªm hÆ°á»›ng dáº«n sá»­ dá»¥ng tiáº¿ng Viá»‡t vÃ o tÃ i liá»‡u nÃ y.

-----

# Ná»n táº£ng Náº¥u Äƒn ThÃ´ng minh AI - HÆ°á»›ng dáº«n cho Copilot

## Tá»•ng quan Kiáº¿n trÃºc

ÄÃ¢y lÃ  má»™t **ná»n táº£ng náº¥u Äƒn theo kiáº¿n trÃºc microservices** vá»›i sá»± tÃ­ch há»£p AI máº¡nh máº½:

  * **Backend**: **Spring Boot** (cá»•ng 8080) - Xá»­ lÃ½ xÃ¡c thá»±c, quáº£n lÃ½ cÃ´ng thá»©c, vÃ  quáº£n lÃ½ ngÆ°á»i dÃ¹ng.
  * **AI Service**: **FastAPI** (cá»•ng 8001) - ChuyÃªn xá»­ lÃ½ tÃ­ch há»£p OpenAI/Gemini vÃ  cÃ¡c tÃ¡c vá»¥ xá»­ lÃ½ giá»ng nÃ³i.
  * **Frontend**: **Next.js** (cá»•ng 3000/3001) - Giao diá»‡n web cho ngÆ°á»i dÃ¹ng vá»›i cÃ¡c tÃ­nh nÄƒng giá»ng nÃ³i vÃ  trÃ² chuyá»‡n.
  * **Mobile**: **Flutter** - á»¨ng dá»¥ng di Ä‘á»™ng Ä‘a ná»n táº£ng.
  * **CÆ¡ sá»Ÿ dá»¯ liá»‡u**: **MySQL** + **Redis** (cho caching/session) + **MinIO** (lÆ°u trá»¯ Ä‘á»‘i tÆ°á»£ng) + **Elasticsearch** (tÃ¬m kiáº¿m).

## ğŸ’¡ Chá»©c nÄƒng Há»‡ thá»‘ng

### ğŸ¯ Core Features
1. **ğŸ“„ Táº¡o cÃ´ng thá»©c tá»« nguyÃªn liá»‡u** - AI sinh cÃ´ng thá»©c tÃ¹y chá»‰nh
2. **ğŸ“¸ Nháº­n dáº¡ng mÃ³n Äƒn qua áº£nh** - Gemini Vision API
3. **ğŸ—£ï¸ Chatbot AI** - Gemini integration cho tÆ° váº¥n náº¥u Äƒn
4. **ğŸ¤ Voice Assistant** - STT + TTS cho tÆ°Æ¡ng tÃ¡c báº±ng giá»ng nÃ³i
5. **ğŸ“ Lá»™ trÃ¬nh há»c náº¥u Äƒn** - AI táº¡o curriculum cÃ¡ nhÃ¢n hÃ³a
6. **ğŸ”„ Lá»‹ch sá»­ tÆ°Æ¡ng tÃ¡c AI** - Tracking vÃ  analytics
7. **ğŸ” Quáº£n lÃ½ ngÆ°á»i dÃ¹ng** - Multi-role system (USER/ADMIN/CHEF)
8. **ğŸ–¼ï¸ Quáº£n lÃ½ media** - Upload, lÆ°u trá»¯ vÃ  nháº­n dáº¡ng áº£nh
9. **ğŸ—‚ï¸ Quáº£n lÃ½ cÃ´ng thá»©c máº«u** - CRUD operations cho admin/chef
10. **ğŸŒ Äa ngÃ´n ngá»¯** - i18n support (EN/VI/...)
11. **ğŸ“ Gá»£i Ã½ theo vÃ¹ng miá»n** - MÃ³n Äƒn Ä‘áº·c trÆ°ng theo vá»‹ trÃ­ Ä‘á»‹a lÃ½
12. **ğŸ›’ TÃ¬m cá»­a hÃ ng nguyÃªn liá»‡u** - Äá»‹nh vá»‹ siÃªu thá»‹, chá»£ gáº§n nháº¥t
13. **ğŸ—ºï¸ Profile áº©m thá»±c vÃ¹ng miá»n** - CÃ¡ nhÃ¢n hÃ³a theo Ä‘á»‹a phÆ°Æ¡ng
14. **ğŸ“Œ Chia sáº» mÃ³n Äƒn cÃ³ vá»‹ trÃ­** - Gáº¯n tag Ä‘á»‹a Ä‘iá»ƒm cho cÃ´ng thá»©c

### ğŸ‘¥ PhÃ¢n quyá»n NgÆ°á»i dÃ¹ng
- **USER**: Táº¡o cÃ´ng thá»©c, chat AI, há»c lá»™ trÃ¬nh, lÆ°u favorites
- **CHEF**: Táº¡o ná»™i dung há»c, quáº£n lÃ½ há»c viÃªn, phÃ¢n tÃ­ch tiáº¿n Ä‘á»™ náº¥u Äƒn
- **ADMIN**: Full system access, user management, analytics

-----

## ğŸ”Œ API Endpoints

### Authentication & User Management
```
POST   /api/auth/google-login     # Google OAuth2 login
GET    /api/auth/me               # Get current user info
PUT    /api/user/{id}/profile     # Update user profile
PUT    /api/user/{id}/language    # Change language preference
DELETE /api/auth/logout           # Logout user
```

### Recipe & AI Features
```
POST   /api/ai/generate-recipe    # Generate recipe from ingredients
POST   /api/ai/vision             # Analyze food image
POST   /api/ai/chat               # Chat with AI assistant
POST   /api/ai/voice              # Voice processing (STT/TTS)
GET    /api/recipes               # Get recipes with filters
POST   /api/recipes               # Create new recipe
PUT    /api/recipes/{id}          # Update recipe
DELETE /api/recipes/{id}          # Delete recipe
```

### Learning & Analytics
```
POST   /api/learning/path         # Create learning path
GET    /api/learning/progress     # Get user progress
GET    /api/analytics/history     # Get interaction history
GET    /api/analytics/stats       # Get usage statistics
POST   /api/feedback              # Submit user feedback
```

### Location & Regional Features
```
PUT    /api/user/location         # Update user location
GET    /api/suggestions/regional  # Get regional food suggestions
GET    /api/stores/nearby         # Find nearby ingredient stores
POST   /api/recipes/location      # Create recipe with location tag
GET    /api/recipes/region/{region} # Get recipes by region
GET    /api/regions/profile       # Get user's regional profile
PUT    /api/regions/preference    # Update regional preference
```

## ğŸ’¾ Database Schema

### Core Tables
```sql
-- Users with Google OAuth2 support
CREATE TABLE users (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    email VARCHAR(255) UNIQUE NOT NULL,
    name VARCHAR(255) NOT NULL,
    avatar VARCHAR(500),
    role ENUM('USER', 'ADMIN', 'CHEF') DEFAULT 'USER',
    provider ENUM('GOOGLE', 'LOCAL') DEFAULT 'LOCAL',
    provider_id VARCHAR(255),
    language_preference VARCHAR(10) DEFAULT 'en',
    latitude DECIMAL(10, 8),
    longitude DECIMAL(11, 8),
    region_preference VARCHAR(50),
    city VARCHAR(100),
    country VARCHAR(50) DEFAULT 'Vietnam',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    is_active BOOLEAN DEFAULT TRUE
);

-- Recipes with multilingual support
CREATE TABLE recipes (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    title_en VARCHAR(255) NOT NULL,
    title_vi VARCHAR(255),
    description_en TEXT,
    description_vi TEXT,
    image_url VARCHAR(500),
    cooking_time INT NOT NULL,
    difficulty ENUM('EASY', 'MEDIUM', 'HARD') DEFAULT 'MEDIUM',
    servings INT DEFAULT 4,
    calories INT,
    created_by BIGINT,
    category_id BIGINT,
    origin_region VARCHAR(100),
    location_tag VARCHAR(255),
    latitude DECIMAL(10, 8),
    longitude DECIMAL(11, 8),
    is_public BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (created_by) REFERENCES users(id),
    FOREIGN KEY (category_id) REFERENCES categories(id)
);

-- AI Interactions for analytics
CREATE TABLE ai_interactions (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NOT NULL,
    interaction_type ENUM('CHAT', 'RECIPE_GENERATION', 'IMAGE_RECOGNITION', 'VOICE') NOT NULL,
    input_data JSON,
    output_data JSON,
    language VARCHAR(10) DEFAULT 'en',
    processing_time_ms INT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
);

-- Learning Paths for educational content
CREATE TABLE learning_paths (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    title_en VARCHAR(255) NOT NULL,
    title_vi VARCHAR(255),
    description_en TEXT,
    description_vi TEXT,
    difficulty_level ENUM('BEGINNER', 'INTERMEDIATE', 'ADVANCED') DEFAULT 'BEGINNER',
    estimated_hours INT DEFAULT 10,
    created_by BIGINT,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (created_by) REFERENCES users(id)
);
```

-----

## ğŸ› ï¸ CÃ¡c Máº«u PhÃ¡t triá»ƒn ChÃ­nh

  * **Backend** sáº½ Ä‘Ã³ng vai trÃ² **proxy** cÃ¡c yÃªu cáº§u liÃªn quan Ä‘áº¿n AI tá»›i service FastAPI táº¡i Ä‘á»‹a chá»‰ `${AI_SERVICE_URL}`.
  * Táº¥t cáº£ cÃ¡c endpoint AI trong Spring Boot sáº½ Ä‘Æ°á»£c tiá»n tá»‘ báº±ng `/api/ai/` vÃ  Ä‘Æ°á»£c chuyá»ƒn tiáº¿p tá»›i FastAPI.
  * CÃ¡c cuá»™c gá»i giá»¯a cÃ¡c service trong Docker sáº½ sá»­ dá»¥ng **tÃªn máº¡ng Docker** (vÃ­ dá»¥: `backend:8080`, `ai-service:8001`) thay vÃ¬ `localhost`.

### Luá»“ng XÃ¡c thá»±c

  * Sá»­ dá»¥ng **Google OAuth2** káº¿t há»£p vá»›i **JWT tokens**.
  * **Frontend** dÃ¹ng **NextAuth.js** Ä‘á»ƒ xá»­ lÃ½ Ä‘Äƒng nháº­p.
  * **Backend** sáº½ xÃ¡c thá»±c cÃ¡c JWT token báº±ng bá»™ lá»c JWT tÃ¹y chá»‰nh.
  * Táº¥t cáº£ cÃ¡c yÃªu cáº§u Ä‘áº¿n AI Service Ä‘á»u yÃªu cáº§u header `Authorization: Bearer <token>`.

### ğŸŒ Äa ngÃ´n ngá»¯ (i18n) - Há»— trá»£ Quá»‘c táº¿ hÃ³a ToÃ n diá»‡n

**Smart Cooking AI** há»— trá»£ Ä‘áº§y Ä‘á»§ **internationalization (i18n)** vá»›i kiáº¿n trÃºc Ä‘a ngÃ´n ngá»¯ máº¡nh máº½:

#### ğŸ¯ **NgÃ´n ngá»¯ Há»— trá»£**
- **ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t (vi)**: NgÃ´n ngá»¯ chÃ­nh, UI máº·c Ä‘á»‹nh
- **ğŸ‡ºğŸ‡¸ English (en)**: Há»— trá»£ quá»‘c táº¿, SEO metadata
- **ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª (ja)**: Sáºµn sÃ ng má»Ÿ rá»™ng cho thá»‹ trÆ°á»ng Nháº­t
- **ğŸ‡°ğŸ‡· í•œêµ­ì–´ (ko)**: Sáºµn sÃ ng má»Ÿ rá»™ng cho thá»‹ trÆ°á»ng HÃ n Quá»‘c
- **ğŸ‡¨ğŸ‡³ ä¸­æ–‡ (zh)**: Sáºµn sÃ ng má»Ÿ rá»™ng cho thá»‹ trÆ°á»ng Trung Quá»‘c

#### ğŸ—ï¸ **Kiáº¿n trÃºc i18n Cross-platform**

##### **Frontend Web (Next.js)**
```javascript
// next-i18next configuration
import { useTranslation } from 'next-i18next';
import { serverSideTranslations } from 'next-i18next/serverSideTranslations';

function RecipePage() {
  const { t, i18n } = useTranslation('common');
  
  const changeLanguage = async (lang) => {
    await i18n.changeLanguage(lang);
    // Update user preference in backend
    await updateUserLanguage(lang);
    // Reload page with new locale
    router.push(router.asPath, router.asPath, { locale: lang });
  };

  return (
    <div>
      <h1>{t('recipe.title')}</h1>
      <p>{t('recipe.description')}</p>
      
      {/* Language Switcher */}
      <div className="language-switcher">
        <button onClick={() => changeLanguage('vi')}>ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t</button>
        <button onClick={() => changeLanguage('en')}>ğŸ‡ºğŸ‡¸ English</button>
        <button onClick={() => changeLanguage('ja')}>ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</button>
      </div>
    </div>
  );
}

// Server-side translations
export async function getStaticProps({ locale }) {
  return {
    props: {
      ...(await serverSideTranslations(locale, ['common', 'recipe', 'ai'])),
    },
  };
}
```

##### **Mobile (Flutter)**
```dart
// easy_localization setup vá»›i Smart Cooking AI
import 'package:easy_localization/easy_localization.dart';

class SmartCookingAIApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'Smart Cooking AI',
      localizationsDelegates: context.localizationDelegates,
      supportedLocales: context.supportedLocales,
      locale: context.locale,
      theme: ThemeData(
        primarySwatch: Colors.green,
        fontFamily: 'NotoSans', // Support for Asian characters
      ),
      home: HomePage(),
    );
  }
}

// Usage in widgets vá»›i context
class RecipeScreen extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('recipe.title'.tr()),
        actions: [
          // Language picker
          PopupMenuButton<String>(
            onSelected: (String languageCode) {
              context.setLocale(Locale(languageCode));
            },
            itemBuilder: (BuildContext context) => [
              PopupMenuItem(value: 'vi', child: Text('ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t')),
              PopupMenuItem(value: 'en', child: Text('ğŸ‡ºğŸ‡¸ English')),
              PopupMenuItem(value: 'ja', child: Text('ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª')),
            ],
          ),
        ],
      ),
      body: Column(
        children: [
          Text('welcome'.tr()),
          Text('ai.recipe_generation'.tr()),
          ElevatedButton(
            onPressed: () => context.setLocale(Locale('vi')),
            child: Text('language.vietnamese'.tr()),
          ),
        ],
      ),
    );
  }
}
```

#### ğŸ—‚ï¸ **Cáº¥u trÃºc Translation Files**

##### **Frontend Web Structure**
```
frontend-web/public/locales/
â”œâ”€â”€ vi/
â”‚   â”œâ”€â”€ common.json          # UI chung, navigation, buttons
â”‚   â”œâ”€â”€ recipe.json          # CÃ´ng thá»©c náº¥u Äƒn
â”‚   â”œâ”€â”€ ai.json             # AI features, chatbot
â”‚   â”œâ”€â”€ voice.json          # Voice assistant
â”‚   â””â”€â”€ auth.json           # Authentication
â”œâ”€â”€ en/
â”‚   â”œâ”€â”€ common.json
â”‚   â”œâ”€â”€ recipe.json
â”‚   â”œâ”€â”€ ai.json
â”‚   â”œâ”€â”€ voice.json
â”‚   â””â”€â”€ auth.json
â””â”€â”€ ja/
    â”œâ”€â”€ common.json
    â”œâ”€â”€ recipe.json
    â”œâ”€â”€ ai.json
    â”œâ”€â”€ voice.json
    â””â”€â”€ auth.json
```

##### **Mobile Structure**
```
mobile-app/assets/translations/
â”œâ”€â”€ vi.json                 # Vietnamese translations
â”œâ”€â”€ en.json                 # English translations
â”œâ”€â”€ ja.json                 # Japanese translations
â””â”€â”€ ko.json                 # Korean translations (ready)
```

#### ğŸ“ **Sample Translation Files**

##### **vi.json (Tiáº¿ng Viá»‡t)**
```json
{
  "app": {
    "name": "Smart Cooking AI",
    "tagline": "Há»‡ thá»‘ng náº¥u Äƒn thÃ´ng minh"
  },
  "navigation": {
    "home": "Trang chá»§",
    "recipes": "CÃ´ng thá»©c",
    "ai_assistant": "Trá»£ lÃ½ AI",
    "voice": "Giá»ng nÃ³i",
    "profile": "Há»“ sÆ¡"
  },
  "recipe": {
    "title": "CÃ´ng thá»©c náº¥u Äƒn",
    "create": "Táº¡o cÃ´ng thá»©c má»›i",
    "ingredients": "NguyÃªn liá»‡u",
    "instructions": "HÆ°á»›ng dáº«n",
    "cooking_time": "Thá»i gian náº¥u",
    "difficulty": "Äá»™ khÃ³",
    "servings": "Kháº©u pháº§n"
  },
  "ai": {
    "recipe_generation": "Táº¡o cÃ´ng thá»©c tá»« AI",
    "image_recognition": "Nháº­n dáº¡ng mÃ³n Äƒn",
    "chatbot": "TrÃ² chuyá»‡n vá»›i AI",
    "voice_assistant": "Trá»£ lÃ½ giá»ng nÃ³i"
  },
  "voice": {
    "start_recording": "Báº¯t Ä‘áº§u ghi Ã¢m",
    "stop_recording": "Dá»«ng ghi Ã¢m",
    "listening": "Äang nghe...",
    "processing": "Äang xá»­ lÃ½...",
    "speak_command": "NÃ³i lá»‡nh cá»§a báº¡n"
  },
  "auth": {
    "login": "ÄÄƒng nháº­p",
    "logout": "ÄÄƒng xuáº¥t",
    "register": "ÄÄƒng kÃ½",
    "google_login": "ÄÄƒng nháº­p vá»›i Google"
  }
}
```

##### **en.json (English)**
```json
{
  "app": {
    "name": "Smart Cooking AI",
    "tagline": "Intelligent Cooking System"
  },
  "navigation": {
    "home": "Home",
    "recipes": "Recipes",
    "ai_assistant": "AI Assistant",
    "voice": "Voice",
    "profile": "Profile"
  },
  "recipe": {
    "title": "Cooking Recipes",
    "create": "Create New Recipe",
    "ingredients": "Ingredients",
    "instructions": "Instructions",
    "cooking_time": "Cooking Time",
    "difficulty": "Difficulty",
    "servings": "Servings"
  },
  "ai": {
    "recipe_generation": "AI Recipe Generation",
    "image_recognition": "Food Recognition",
    "chatbot": "Chat with AI",
    "voice_assistant": "Voice Assistant"
  },
  "voice": {
    "start_recording": "Start Recording",
    "stop_recording": "Stop Recording",
    "listening": "Listening...",
    "processing": "Processing...",
    "speak_command": "Speak your command"
  },
  "auth": {
    "login": "Login",
    "logout": "Logout",
    "register": "Register",
    "google_login": "Login with Google"
  }
}
```

#### ğŸ¨ **RTL Support & Typography**

##### **CSS cho Multi-language**
```css
/* Smart Cooking AI - Multi-language CSS */
[dir="rtl"] {
  text-align: right;
  direction: rtl;
}

[dir="ltr"] {
  text-align: left;
  direction: ltr;
}

/* Font families for different languages */
.font-vietnamese {
  font-family: 'Inter', 'Noto Sans Vietnamese', sans-serif;
}

.font-english {
  font-family: 'Inter', 'Roboto', sans-serif;
}

.font-japanese {
  font-family: 'Noto Sans JP', 'Hiragino Sans', sans-serif;
}

.font-korean {
  font-family: 'Noto Sans KR', 'Malgun Gothic', sans-serif;
}

.font-chinese {
  font-family: 'Noto Sans SC', 'PingFang SC', sans-serif;
}
```

#### ğŸ”„ **Dynamic Language Switching**

##### **Language Context Provider**
```typescript
// contexts/LanguageContext.tsx
import { createContext, useContext, useState, useEffect } from 'react';

interface LanguageContextType {
  currentLanguage: string;
  supportedLanguages: Array<{code: string, name: string, flag: string}>;
  changeLanguage: (lang: string) => Promise<void>;
  isRTL: boolean;
}

const SUPPORTED_LANGUAGES = [
  { code: 'vi', name: 'Tiáº¿ng Viá»‡t', flag: 'ğŸ‡»ğŸ‡³' },
  { code: 'en', name: 'English', flag: 'ğŸ‡ºğŸ‡¸' },
  { code: 'ja', name: 'æ—¥æœ¬èª', flag: 'ğŸ‡¯ğŸ‡µ' },
  { code: 'ko', name: 'í•œêµ­ì–´', flag: 'ğŸ‡°ğŸ‡·' },
  { code: 'zh', name: 'ä¸­æ–‡', flag: 'ğŸ‡¨ğŸ‡³' },
];

export const LanguageProvider: React.FC<{children: React.ReactNode}> = ({ children }) => {
  const [currentLanguage, setCurrentLanguage] = useState('vi');
  
  const changeLanguage = async (lang: string) => {
    setCurrentLanguage(lang);
    localStorage.setItem('preferred-language', lang);
    
    // Update user preference in backend
    await fetch('/api/user/language', {
      method: 'PUT',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ language: lang })
    });
  };

  return (
    <LanguageContext.Provider value={{
      currentLanguage,
      supportedLanguages: SUPPORTED_LANGUAGES,
      changeLanguage,
      isRTL: ['ar', 'fa', 'he'].includes(currentLanguage)
    }}>
      {children}
    </LanguageContext.Provider>
  );
};
```

#### ğŸ—„ï¸ **Database Schema cho i18n**

```sql
-- Enhanced user table with language preference
ALTER TABLE users ADD COLUMN language_preference VARCHAR(10) DEFAULT 'vi';
ALTER TABLE users ADD COLUMN timezone VARCHAR(50) DEFAULT 'Asia/Ho_Chi_Minh';
ALTER TABLE users ADD COLUMN date_format VARCHAR(20) DEFAULT 'dd/MM/yyyy';

-- Multilingual content tables
CREATE TABLE recipe_translations (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    recipe_id BIGINT NOT NULL,
    language_code VARCHAR(10) NOT NULL,
    title VARCHAR(255) NOT NULL,
    description TEXT,
    instructions TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (recipe_id) REFERENCES recipes(id),
    UNIQUE KEY unique_recipe_language (recipe_id, language_code)
);

CREATE TABLE category_translations (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    category_id BIGINT NOT NULL,
    language_code VARCHAR(10) NOT NULL,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    FOREIGN KEY (category_id) REFERENCES categories(id),
    UNIQUE KEY unique_category_language (category_id, language_code)
);

-- AI interactions with language tracking
ALTER TABLE ai_interactions ADD COLUMN user_language VARCHAR(10) DEFAULT 'vi';
ALTER TABLE ai_interactions ADD COLUMN response_language VARCHAR(10) DEFAULT 'vi';
```

#### ğŸ¤– **AI Service i18n Support**

```python
# AI Service vá»›i multilingual support
class MultilingualAIService:
    def __init__(self):
        self.supported_languages = ['vi', 'en', 'ja', 'ko', 'zh']
        self.default_language = 'vi'
    
    async def generate_recipe(self, ingredients: List[str], user_language: str = 'vi'):
        """Generate recipe in user's preferred language"""
        
        # Language-specific prompts
        prompts = {
            'vi': f"Táº¡o cÃ´ng thá»©c náº¥u Äƒn tá»« cÃ¡c nguyÃªn liá»‡u: {', '.join(ingredients)}",
            'en': f"Create a cooking recipe using ingredients: {', '.join(ingredients)}",
            'ja': f"ææ–™ã‚’ä½¿ã£ãŸæ–™ç†ãƒ¬ã‚·ãƒ”ã‚’ä½œæˆã—ã¦ãã ã•ã„: {', '.join(ingredients)}",
            'ko': f"ì¬ë£Œë¥¼ ì‚¬ìš©í•œ ìš”ë¦¬ ë ˆì‹œí”¼ë¥¼ ë§Œë“¤ì–´ ì£¼ì„¸ìš”: {', '.join(ingredients)}",
            'zh': f"ä½¿ç”¨ä»¥ä¸‹é£Ÿæåˆ›å»ºçƒ¹é¥ªé£Ÿè°±: {', '.join(ingredients)}"
        }
        
        prompt = prompts.get(user_language, prompts['vi'])
        
        response = await openai_client.chat.completions.create(
            model="gpt-4",
            messages=[
                {"role": "system", "content": f"You are a helpful cooking assistant. Respond in {user_language}."},
                {"role": "user", "content": prompt}
            ]
        )
        
        return {
            "recipe": response.choices[0].message.content,
            "language": user_language,
            "ingredients": ingredients
        }
    
    async def voice_to_text(self, audio_file, language: str = 'vi'):
        """Convert speech to text with language support"""
        
        # Language-specific voice models
        language_models = {
            'vi': 'vietnamese-voice-model',
            'en': 'english-voice-model',
            'ja': 'japanese-voice-model',
            'ko': 'korean-voice-model',
            'zh': 'chinese-voice-model'
        }
        
        model = language_models.get(language, language_models['vi'])
        
        transcript = await speech_to_text_service.transcribe(
            audio_file, 
            model=model,
            language=language
        )
        
        return {
            "transcript": transcript,
            "language": language,
            "confidence": 0.95
        }
```

#### ğŸ“± **Mobile i18n Best Practices**

```dart
// Smart Cooking AI Mobile - Advanced i18n
class LocalizationService {
  static const List<Locale> supportedLocales = [
    Locale('vi', 'VN'),
    Locale('en', 'US'),
    Locale('ja', 'JP'),
    Locale('ko', 'KR'),
    Locale('zh', 'CN'),
  ];
  
  static String getLanguageName(String languageCode) {
    switch (languageCode) {
      case 'vi': return 'ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t';
      case 'en': return 'ğŸ‡ºğŸ‡¸ English';
      case 'ja': return 'ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª';
      case 'ko': return 'ğŸ‡°ğŸ‡· í•œêµ­ì–´';
      case 'zh': return 'ğŸ‡¨ğŸ‡³ ä¸­æ–‡';
      default: return 'ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t';
    }
  }
  
  static Future<void> changeLanguage(BuildContext context, String languageCode) async {
    await context.setLocale(Locale(languageCode));
    
    // Save to local storage
    final prefs = await SharedPreferences.getInstance();
    await prefs.setString('language', languageCode);
    
    // Update backend
    await ApiService.updateUserLanguage(languageCode);
  }
}

// Usage in widgets
class LanguageSwitcher extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return DropdownButton<String>(
      value: context.locale.languageCode,
      items: LocalizationService.supportedLocales.map((locale) {
        return DropdownMenuItem(
          value: locale.languageCode,
          child: Text(LocalizationService.getLanguageName(locale.languageCode)),
        );
      }).toList(),
      onChanged: (String? languageCode) {
        if (languageCode != null) {
          LocalizationService.changeLanguage(context, languageCode);
        }
      },
    );
  }
}
```

#### ğŸŒ **SEO & Metadata i18n**

```typescript
// Next.js SEO vá»›i i18n
export const generateMetadata = ({ params }: { params: { locale: string } }) => {
  const metadata = {
    vi: {
      title: 'Smart Cooking AI - Há»‡ thá»‘ng Náº¥u Äƒn ThÃ´ng minh',
      description: 'Ná»n táº£ng náº¥u Äƒn tÃ­ch há»£p AI, trá»£ lÃ½ giá»ng nÃ³i vÃ  nháº­n dáº¡ng mÃ³n Äƒn thÃ´ng minh',
      keywords: 'náº¥u Äƒn, AI, cÃ´ng thá»©c, giá»ng nÃ³i, thÃ´ng minh'
    },
    en: {
      title: 'Smart Cooking AI - Intelligent Cooking System',
      description: 'AI-powered cooking platform with voice assistant and smart food recognition',
      keywords: 'cooking, AI, recipes, voice, smart, assistant'
    },
    ja: {
      title: 'Smart Cooking AI - ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆæ–™ç†ã‚·ã‚¹ãƒ†ãƒ ',
      description: 'AIæ­è¼‰ã®æ–™ç†ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã€éŸ³å£°ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã¨ã‚¹ãƒãƒ¼ãƒˆãƒ•ãƒ¼ãƒ‰èªè­˜',
      keywords: 'æ–™ç†, AI, ãƒ¬ã‚·ãƒ”, éŸ³å£°, ã‚¹ãƒãƒ¼ãƒˆ, ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ'
    }
  };
  
  const locale = params.locale || 'vi';
  const meta = metadata[locale] || metadata.vi;
  
  return {
    title: meta.title,
    description: meta.description,
    keywords: meta.keywords,
    openGraph: {
      title: meta.title,
      description: meta.description,
      locale: locale,
      alternateLocale: Object.keys(metadata).filter(l => l !== locale),
    }
  };
};
```

#### ğŸ¯ **Implementation Guidelines**

1. **ğŸ”§ Setup Priority**: CÃ i Ä‘áº·t i18n cho Frontend trÆ°á»›c, sau Ä‘Ã³ Mobile
2. **ğŸ“ Content Strategy**: Tiáº¿ng Viá»‡t lÃ m content chÃ­nh, English cho SEO quá»‘c táº¿  
3. **ğŸ¤– AI Integration**: AI responses pháº£i match vá»›i ngÃ´n ngá»¯ cá»§a user
4. **ğŸ¤ Voice Support**: STT/TTS há»— trá»£ multi-language
5. **ğŸ—„ï¸ Database**: Multilingual schema cho táº¥t cáº£ user-generated content
6. **ğŸ“± Mobile**: Easy language switcher trong settings
7. **ğŸ”„ Sync**: Language preference sync giá»¯a web vÃ  mobile

#### âœ… **Testing Strategy**

- **Unit Tests**: Test translation files integrity
- **E2E Tests**: Test language switching flows  
- **Voice Tests**: Test STT/TTS trong cÃ¡c ngÃ´n ngá»¯ khÃ¡c nhau
- **API Tests**: Test multilingual API responses
- **UI Tests**: Test layout vá»›i different text lengths

### ï¿½ **TÃ­nh nÄƒng Dá»±a trÃªn Vá»‹ trÃ­ (Geolocation Features)**

**Smart Cooking AI** tÃ­ch há»£p Ä‘á»‹nh vá»‹ Ä‘á»ƒ cÃ¡ nhÃ¢n hÃ³a tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng vÃ  cung cáº¥p gá»£i Ã½ phÃ¹ há»£p vá»›i vÄƒn hÃ³a áº©m thá»±c Ä‘á»‹a phÆ°Æ¡ng.

#### ğŸ² **Gá»£i Ã½ mÃ³n Äƒn theo vÃ¹ng miá»n**

**MÃ´ táº£**: Dá»±a trÃªn vá»‹ trÃ­ hiá»‡n táº¡i cá»§a ngÆ°á»i dÃ¹ng (vÃ­ dá»¥: miá»n Báº¯c, Trung, Nam Viá»‡t Nam), AI sáº½ gá»£i Ã½ cÃ¡c mÃ³n Äƒn Ä‘áº·c trÆ°ng cá»§a vÃ¹ng Ä‘Ã³.

**VÃ­ dá»¥ thá»±c táº¿**:
- *"Báº¡n Ä‘ang á»Ÿ Huáº¿? HÃ´m nay thá»­ bÃºn bÃ² Huáº¿ nhÃ©!"*
- *"á» HÃ  Ná»™i rá»“i Ã ? Phá»Ÿ HÃ  Ná»™i chÃ­nh hiá»‡u Ä‘Ã¢y!"*
- *"SÃ i GÃ²n nÃ³ng quÃ¡, lÃ m chÃ©n chÃ¨ ba mÃ u cho mÃ¡t nhÃ©!"*

```python
# AI Service vá»›i regional suggestions
async def get_regional_suggestions(user_location: dict, user_language: str = 'vi'):
    """Get food suggestions based on user's current location"""
    
    # Vietnam regional mapping
    regional_specialties = {
        'mien_bac': {
            'vi': ['Phá»Ÿ HÃ  Ná»™i', 'BÃºn cháº£', 'Cháº£ cÃ¡ LÃ£ Vá»ng', 'BÃ¡nh cuá»‘n'],
            'en': ['Hanoi Pho', 'Bun Cha', 'Cha Ca La Vong', 'Banh Cuon']
        },
        'mien_trung': {
            'vi': ['BÃºn bÃ² Huáº¿', 'MÃ¬ Quáº£ng', 'Cao láº§u', 'BÃ¡nh khoÃ¡i'],
            'en': ['Hue Beef Noodle Soup', 'Mi Quang', 'Cao Lau', 'Banh Khoai']
        },
        'mien_nam': {
            'vi': ['BÃºn thá»‹t nÆ°á»›ng', 'BÃ¡nh xÃ¨o', 'Há»§ tiáº¿u', 'ChÃ¨ ba mÃ u'],
            'en': ['Grilled Pork Vermicelli', 'Banh Xeo', 'Hu Tieu', 'Three-Color Dessert']
        }
    }
    
    # Detect region based on coordinates
    region = detect_vietnam_region(user_location['latitude'], user_location['longitude'])
    
    suggestions = regional_specialties.get(region, {}).get(user_language, [])
    
    return {
        "region": region,
        "suggestions": suggestions,
        "message": f"regional_suggestions.{region}".format(region=region)
    }

def detect_vietnam_region(lat: float, lng: float) -> str:
    """Detect Vietnam region based on coordinates"""
    if lat > 20.0:  # Roughly north of Thanh Hoa
        return 'mien_bac'
    elif lat > 16.0:  # Between Thanh Hoa and Da Nang
        return 'mien_trung'
    else:  # South of Da Nang
        return 'mien_nam'
```

#### ğŸ›’ **TÃ¬m cá»­a hÃ ng nguyÃªn liá»‡u gáº§n nháº¥t**

**MÃ´ táº£**: Gá»£i Ã½ cÃ¡c siÃªu thá»‹, chá»£ hoáº·c cá»­a hÃ ng chuyÃªn dá»¥ng bÃ¡n nguyÃªn liá»‡u cho má»™t cÃ´ng thá»©c cá»¥ thá»ƒ, dá»±a trÃªn vá»‹ trÃ­ cá»§a ngÆ°á»i dÃ¹ng.

**TÃ­ch há»£p**: 
- **Google Maps API**: TÃ¬m kiáº¿m vÃ  hiá»ƒn thá»‹ Ä‘Æ°á»ng Ä‘i
- **Places API**: ThÃ´ng tin chi tiáº¿t vá» cá»­a hÃ ng
- **Directions API**: Route optimization

```typescript
// Frontend service cho store locator
export class StoreLocatorService {
  private googleMapsApi: string;
  
  async findNearbyStores(userLocation: LatLng, ingredients: string[]): Promise<Store[]> {
    const storeTypes = this.categorizeIngredients(ingredients);
    const nearbyStores: Store[] = [];
    
    // Search for different types of stores
    for (const storeType of storeTypes) {
      const stores = await this.searchStoresByType(userLocation, storeType);
      nearbyStores.push(...stores);
    }
    
    // Sort by distance and rating
    return nearbyStores.sort((a, b) => a.distance - b.distance);
  }
  
  private categorizeIngredients(ingredients: string[]): StoreType[] {
    const categories = new Set<StoreType>();
    
    for (const ingredient of ingredients) {
      if (this.isMeat(ingredient)) categories.add('butcher');
      if (this.isSeafood(ingredient)) categories.add('fish_market');
      if (this.isVegetable(ingredient)) categories.add('vegetable_market');
      if (this.isSpice(ingredient)) categories.add('spice_shop');
      categories.add('supermarket'); // Fallback
    }
    
    return Array.from(categories);
  }
  
  async getDirections(from: LatLng, to: LatLng): Promise<Route> {
    // Google Directions API integration
    const response = await fetch(`https://maps.googleapis.com/maps/api/directions/json?origin=${from.lat},${from.lng}&destination=${to.lat},${to.lng}&key=${this.googleMapsApi}`);
    return response.json();
  }
}
```

#### ğŸ—ºï¸ **XÃ¢y dá»±ng Profile áº©m thá»±c vÃ¹ng miá»n**

**MÃ´ táº£**: Tá»± Ä‘á»™ng lÆ°u `region_preference` cá»§a ngÆ°á»i dÃ¹ng dá»±a trÃªn vá»‹ trÃ­ thÆ°á»ng xuyÃªn truy cáº­p.

**á»¨ng dá»¥ng**: AI sáº½ sá»­ dá»¥ng thÃ´ng tin nÃ y Ä‘á»ƒ táº¡o ra cÃ¡c lá»™ trÃ¬nh há»c náº¥u Äƒn phÃ¹ há»£p vá»›i kháº©u vá»‹ vÃ  nguyÃªn liá»‡u Ä‘á»‹a phÆ°Æ¡ng.

```sql
-- Regional profile tracking table
CREATE TABLE user_location_history (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NOT NULL,
    latitude DECIMAL(10, 8) NOT NULL,
    longitude DECIMAL(11, 8) NOT NULL,
    region VARCHAR(50),
    city VARCHAR(100),
    visit_count INT DEFAULT 1,
    last_visited TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id),
    UNIQUE KEY unique_user_location (user_id, latitude, longitude)
);

-- Regional cuisine preferences
CREATE TABLE user_regional_preferences (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NOT NULL,
    region VARCHAR(50) NOT NULL,
    preference_score DECIMAL(3, 2) DEFAULT 0.5, -- 0.0 to 1.0
    favorite_dishes JSON,
    dietary_restrictions JSON,
    spice_tolerance ENUM('LOW', 'MEDIUM', 'HIGH') DEFAULT 'MEDIUM',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id),
    UNIQUE KEY unique_user_region (user_id, region)
);
```

```python
# Backend service cho regional profiling
class RegionalProfileService:
    def __init__(self, db_session):
        self.db = db_session
    
    async def update_user_location(self, user_id: int, location: dict):
        """Update user location and build regional profile"""
        
        # Detect region
        region = detect_vietnam_region(location['latitude'], location['longitude'])
        
        # Update location history
        await self.update_location_history(user_id, location, region)
        
        # Update regional preferences
        await self.update_regional_preferences(user_id, region)
        
        return {
            "region": region,
            "updated_profile": True
        }
    
    async def get_personalized_learning_path(self, user_id: int):
        """Create learning path based on regional preferences"""
        
        preferences = await self.get_user_regional_preferences(user_id)
        primary_region = preferences.get('primary_region', 'mien_bac')
        
        # Create learning curriculum based on region
        curriculum = {
            'mien_bac': ['Phá»Ÿ cÆ¡ báº£n', 'BÃºn cháº£', 'BÃ¡nh cuá»‘n', 'Cháº£ cÃ¡'],
            'mien_trung': ['BÃºn bÃ² Huáº¿', 'MÃ¬ Quáº£ng', 'BÃ¡nh khoÃ¡i', 'Nem lá»¥i'],
            'mien_nam': ['BÃ¡nh xÃ¨o', 'Há»§ tiáº¿u', 'BÃ¡nh mÃ¬', 'ChÃ¨ Ä‘áº­u xanh']
        }
        
        return {
            "region": primary_region,
            "learning_path": curriculum.get(primary_region, []),
            "estimated_weeks": len(curriculum.get(primary_region, [])) * 2
        }
```

#### ğŸ“ **Chia sáº» mÃ³n Äƒn gáº¯n vá»›i vá»‹ trÃ­**

**MÃ´ táº£**: Cho phÃ©p ngÆ°á»i dÃ¹ng "check-in" hoáº·c gáº¯n tháº» vá»‹ trÃ­ Ä‘á»‹a lÃ½ khi chia sáº» má»™t cÃ´ng thá»©c hoáº·c má»™t mÃ³n Äƒn Ä‘Ã£ náº¥u.

**VÃ­ dá»¥**: 
- *"MÃ³n cÃ¡ kho lÃ ng VÅ© Äáº¡i táº¡i HÃ  Nam"*
- *"Phá»Ÿ ThÃ¬n HÃ  Ná»™i chÃ­nh hiá»‡u"*
- *"BÃ¡nh xÃ¨o miá»n TÃ¢y táº¡i Cáº§n ThÆ¡"*

```typescript
// Frontend component cho location tagging
export const RecipeLocationTagger: React.FC = () => {
  const [currentLocation, setCurrentLocation] = useState<LatLng | null>(null);
  const [locationTag, setLocationTag] = useState<string>('');
  const [isLocationEnabled, setIsLocationEnabled] = useState(false);
  
  const getCurrentLocation = () => {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(
        (position) => {
          const location = {
            lat: position.coords.latitude,
            lng: position.coords.longitude
          };
          setCurrentLocation(location);
          reverseGeocode(location);
        },
        (error) => console.error('Location error:', error)
      );
    }
  };
  
  const reverseGeocode = async (location: LatLng) => {
    try {
      const response = await fetch(`/api/geocode/reverse?lat=${location.lat}&lng=${location.lng}`);
      const data = await response.json();
      setLocationTag(data.formatted_address);
    } catch (error) {
      console.error('Reverse geocoding failed:', error);
    }
  };
  
  return (
    <div className="location-tagger">
      <div className="flex items-center space-x-2">
        <input
          type="checkbox"
          checked={isLocationEnabled}
          onChange={(e) => setIsLocationEnabled(e.target.checked)}
          className="rounded"
        />
        <label>ğŸ“ Gáº¯n vá»‹ trÃ­ cho mÃ³n Äƒn</label>
      </div>
      
      {isLocationEnabled && (
        <div className="mt-2">
          <button
            onClick={getCurrentLocation}
            className="btn btn-outline btn-sm"
          >
            ğŸ“ Láº¥y vá»‹ trÃ­ hiá»‡n táº¡i
          </button>
          
          {locationTag && (
            <div className="mt-2 p-2 bg-blue-50 rounded">
              <span className="text-sm text-blue-700">
                ğŸ“ {locationTag}
              </span>
            </div>
          )}
        </div>
      )}
    </div>
  );
};
```

#### ğŸ—ºï¸ **Google Maps Integration**

```typescript
// Maps service integration
export class GoogleMapsService {
  private map: google.maps.Map;
  private placesService: google.maps.places.PlacesService;
  
  async initializeMap(element: HTMLElement, center: LatLng) {
    this.map = new google.maps.Map(element, {
      center,
      zoom: 15,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    });
    
    this.placesService = new google.maps.places.PlacesService(this.map);
  }
  
  async searchNearbyStores(location: LatLng, storeType: string): Promise<Place[]> {
    return new Promise((resolve, reject) => {
      const request = {
        location: new google.maps.LatLng(location.lat, location.lng),
        radius: 2000, // 2km radius
        type: storeType,
        keyword: 'supermarket grocery food market'
      };
      
      this.placesService.nearbySearch(request, (results, status) => {
        if (status === google.maps.places.PlacesServiceStatus.OK) {
          resolve(results || []);
        } else {
          reject(new Error(`Places search failed: ${status}`));
        }
      });
    });
  }
  
  addStoreMarkers(stores: Place[]) {
    stores.forEach(store => {
      const marker = new google.maps.Marker({
        position: store.geometry?.location,
        map: this.map,
        title: store.name,
        icon: {
          url: '/icons/store-marker.png',
          scaledSize: new google.maps.Size(30, 30)
        }
      });
      
      const infoWindow = new google.maps.InfoWindow({
        content: `
          <div>
            <h4>${store.name}</h4>
            <p>Rating: ${store.rating} â­</p>
            <p>${store.vicinity}</p>
            <button onclick="getDirections('${store.place_id}')">
              Chá»‰ Ä‘Æ°á»ng
            </button>
          </div>
        `
      });
      
      marker.addListener('click', () => {
        infoWindow.open(this.map, marker);
      });
    });
  }
}
```

### ï¿½ğŸ¤ Voice Assistant Architecture

#### STT (Speech-to-Text) Flow
```python
# FastAPI voice service
@app.post("/api/voice/stt")
async def speech_to_text(audio: UploadFile):
    # Convert audio to text using OpenAI Whisper or Google STT
    transcript = await stt_service.transcribe(audio)
    # Extract intent and entities
    intent = await nlp_service.extract_intent(transcript)
    return {"transcript": transcript, "intent": intent}
```

#### TTS (Text-to-Speech) Flow
```python
@app.post("/api/voice/tts")
async def text_to_speech(request: TTSRequest):
    # Generate speech from text
    audio_data = await tts_service.synthesize(
        text=request.text,
        language=request.language,
        voice=request.voice_type
    )
    return StreamingResponse(audio_data, media_type="audio/mpeg")
```

#### Voice Command Processing
```python
class VoiceCommandProcessor:
    def __init__(self):
        self.intent_patterns = {
            'create_recipe': r'(táº¡o|lÃ m|náº¥u).*?(mÃ³n|cÃ´ng thá»©c)',
            'find_recipe': r'(tÃ¬m|kiáº¿m).*?(mÃ³n|cÃ´ng thá»©c)',
            'change_language': r'(Ä‘á»•i|chuyá»ƒn).*?(ngÃ´n ngá»¯|tiáº¿ng)',
            'nutrition_analysis': r'(phÃ¢n tÃ­ch|kiá»ƒm tra).*?(dinh dÆ°á»¡ng|calo)'
        }
    
    async def process_command(self, transcript: str, user_language: str):
        intent = self.extract_intent(transcript)
        return await self.execute_intent(intent, transcript, user_language)
```

### ğŸ“Š Analytics & Looker Studio Integration

#### Data Collection
```java
@Service
public class AnalyticsService {
    public void trackAIInteraction(Long userId, String interactionType, 
                                 Object inputData, Object outputData) {
        AIInteraction interaction = AIInteraction.builder()
            .userId(userId)
            .interactionType(InteractionType.valueOf(interactionType))
            .inputData(objectMapper.writeValueAsString(inputData))
            .outputData(objectMapper.writeValueAsString(outputData))
            .language(getCurrentUserLanguage())
            .processingTimeMs(System.currentTimeMillis() - startTime)
            .build();
        
        aiInteractionRepository.save(interaction);
        
        // Send to analytics pipeline
        analyticsPublisher.publish(interaction);
    }
}
```

#### Looker Studio Connector
```sql
-- Analytics views for Looker Studio
CREATE VIEW analytics_daily_usage AS
SELECT 
    DATE(created_at) as date,
    interaction_type,
    language,
    COUNT(*) as interaction_count,
    AVG(processing_time_ms) as avg_processing_time,
    COUNT(DISTINCT user_id) as unique_users
FROM ai_interactions 
GROUP BY DATE(created_at), interaction_type, language;

CREATE VIEW analytics_recipe_popularity AS
SELECT 
    r.id,
    r.title_en,
    r.title_vi,
    COUNT(DISTINCT ai.user_id) as unique_users_generated,
    AVG(r.calories) as avg_calories,
    r.difficulty,
    COUNT(*) as generation_count
FROM recipes r
JOIN ai_interactions ai ON JSON_EXTRACT(ai.output_data, '$.recipe_id') = r.id
WHERE ai.interaction_type = 'RECIPE_GENERATION'
GROUP BY r.id;
```

### Quy Æ°á»›c Cáº¥u trÃºc ThÆ° má»¥c

```
backend/src/main/java/com/cookingapp/
â”œâ”€â”€ controller/        # CÃ¡c REST endpoint, sá»­ dá»¥ng @CrossOrigin cho CORS
â”œâ”€â”€ service/           # Logic nghiá»‡p vá»¥, gá»i AI service qua WebClient
â”œâ”€â”€ config/            # Cáº¥u hÃ¬nh báº£o máº­t, CORS, DB
â”œâ”€â”€ entity/            # CÃ¡c entity JPA vá»›i Lombok @Data
â””â”€â”€ dto/               # CÃ¡c Ä‘á»‘i tÆ°á»£ng Request/Response

ai-service/src/
â”œâ”€â”€ main.py            # á»¨ng dá»¥ng FastAPI vá»›i middleware CORS
â”œâ”€â”€ services/          # openai_service.py, gemini_service.py, voice_processing.py
â”œâ”€â”€ routes/            # CÃ¡c handler Ä‘á»‹nh tuyáº¿n API
â””â”€â”€ utils/             # helpers.py, constants.py

frontend-web/src/
â”œâ”€â”€ app/               # Next.js 14 app router
â”œâ”€â”€ components/        # Sáº¯p xáº¿p theo tÃ­nh nÄƒng (ai/, recipes/, voice/)
â”œâ”€â”€ hooks/             # useAuth.ts, useAI.ts, useVoice.ts
â””â”€â”€ types/             # Äá»‹nh nghÄ©a TypeScript
```

### Lá»‡nh Docker & CÆ¡ sá»Ÿ dá»¯ liá»‡u

```bash
# Khá»Ÿi Ä‘á»™ng chá»‰ cÃ¡c service cá»‘t lÃµi
docker-compose up -d mysql redis minio

# Khá»Ÿi Ä‘á»™ng toÃ n bá»™ stack
docker-compose up -d

# Cháº¿ Ä‘á»™ phÃ¡t triá»ƒn cho tá»«ng service riÃªng láº»
cd backend && ./mvnw spring-boot:run
cd ai-service && uvicorn src.main:app --reload --port 8001
cd frontend-web && npm run dev
```

### Cáº¥u hÃ¬nh MÃ´i trÆ°á»ng

  * Sao chÃ©p `.env.example` sang `.env` vÃ  cáº¥u hÃ¬nh cÃ¡c khÃ³a API.
  * CÃ¡c biáº¿n quan trá»ng: `OPENAI_API_KEY`, `GEMINI_API_KEY`, `GOOGLE_CLIENT_ID/SECRET`.
  * Backend sá»­ dá»¥ng `application.properties` vá»›i máº«u `${VAR_NAME:default}`.
  * AI service táº£i biáº¿n mÃ´i trÆ°á»ng tá»« `.env` thÃ´ng qua `python-dotenv`.

### CÃ¡c Máº«u API

**Spring Boot Controllers:**

```java
@RestController
@RequestMapping("/api/ai")
@RequiredArgsConstructor
@CrossOrigin(origins = {"http://localhost:3000", "http://localhost:3001"})
public class AIController {
    @PostMapping("/chat")
    public ResponseEntity<?> chat(@RequestBody ChatRequest request,
                                  @RequestHeader("Authorization") String token) {
        // á»¦y quyá»n cho AI service
    }
}
```

**FastAPI Services:**

```python
@app.post("/api/ai/chat")
async def chat_with_ai(request: ChatRequest):
    return await openai_service.chat_response(request.message, request.context)
```

### Chiáº¿n lÆ°á»£c Kiá»ƒm thá»­

  * Backend: `./mvnw test` (kiá»ƒm thá»­ tÃ­ch há»£p vá»›i TestRestTemplate).
  * Frontend: `npm run test` (Jest + Testing Library).
  * AI Service: `pytest` vá»›i cÃ¡c fixtures kiá»ƒm thá»­ báº¥t Ä‘á»“ng bá»™.

### TÃ­ch há»£p Giá»ng nÃ³i & AI

  * Xá»­ lÃ½ giá»ng nÃ³i sá»­ dá»¥ng cÃ¡c API cá»§a trÃ¬nh duyá»‡t (SpeechRecognition/SpeechSynthesis) káº¿t há»£p vá»›i STT/TTS phÃ­a server.
  * Táº¡o cÃ´ng thá»©c yÃªu cáº§u má»™t máº£ng nguyÃªn liá»‡u vÃ  má»™t Ä‘á»‘i tÆ°á»£ng tÃ¹y chá»n.
  * PhÃ¢n tÃ­ch hÃ¬nh áº£nh sá»­ dá»¥ng Gemini Vision API thÃ´ng qua upload multipart.
  * Táº¥t cáº£ pháº£n há»“i tá»« AI tuÃ¢n theo má»™t máº«u xá»­ lÃ½ lá»—i nháº¥t quÃ¡n.

### CÃ¡c Váº¥n Ä‘á» Phá»• biáº¿n & Giáº£i phÃ¡p

  * **CORS**: Cáº¥u hÃ¬nh trong cáº£ Spring Boot WebConfig vÃ  middleware CORS cá»§a FastAPI.
  * **Táº£i lÃªn tá»‡p**: Sá»­ dá»¥ng `MultipartFile` trong Spring Boot, `UploadFile` trong FastAPI.
  * **Máº¡ng Docker**: CÃ¡c service giao tiáº¿p qua tÃªn container, khÃ´ng pháº£i `localhost`.
  * **Táº£i biáº¿n mÃ´i trÆ°á»ng**: Backend tá»± Ä‘á»™ng táº£i tá»« mÃ´i trÆ°á»ng, AI service cáº§n `dotenv` rÃµ rÃ ng.

-----

## PhÃ¡t triá»ƒn á»¨ng dá»¥ng Di Ä‘á»™ng (Flutter)

  * Sá»­ dá»¥ng máº«u **Provider** Ä‘á»ƒ quáº£n lÃ½ tráº¡ng thÃ¡i.
  * CÃ¡c service trong `lib/services/` pháº£n Ã¡nh cáº¥u trÃºc API cá»§a backend.
  * CÃ¡c widget Ä‘Æ°á»£c tá»• chá»©c theo tÃ­nh nÄƒng trong `lib/widgets/`.
  * Ghi Ã¢m giá»ng nÃ³i qua cÃ¡c gÃ³i `speech_to_text` vÃ  `flutter_tts`.

-----

-----

## ğŸ’¼ PhÃ¢n vai Team & Development Strategy

### ğŸ—ï¸ Team Structure (4 developers)

| Vai trÃ²                    | Nhiá»‡m vá»¥ chÃ­nh                                     | Tech Stack                           |
| -------------------------- | --------------------------------------------------- | ------------------------------------ |
| Backend Dev (AI + Voice)   | GPT/Gemini integration, Voice AI, FastAPI services | Python, FastAPI, OpenAI, Gemini API |
| Backend Dev (Logic + Auth) | CRUD, Google OAuth2, roles, i18n backend          | Spring Boot, MySQL, JWT, Docker     |
| Web Dev (Next.js)          | UI/UX web, chatbot, OAuth2 client, i18n frontend  | Next.js, React, NextAuth, Tailwind  |
| Mobile Dev (Flutter)       | Voice/chat/AI, mobile UI, OAuth2, i18n mobile     | Flutter, Dart, Material Design      |

### ğŸš€ Development Workflow

#### Phase 1: Foundation (Weeks 1-2)
- [ ] Database schema & Docker setup
- [ ] Spring Boot API structure vá»›i authentication
- [ ] Next.js basic layout vá»›i routing
- [ ] Flutter app structure vá»›i navigation

#### Phase 2: Core Features (Weeks 3-4)
- [ ] Recipe CRUD operations
- [ ] Google OAuth2 implementation
- [ ] Basic AI chat integration
- [ ] i18n setup for both web & mobile

#### Phase 3: AI Integration (Weeks 5-6)
- [ ] FastAPI AI service development
- [ ] Recipe generation vá»›i ingredients
- [ ] Image recognition vá»›i Gemini Vision
- [ ] Voice assistant STT/TTS

#### Phase 4: Advanced Features (Weeks 7-8)
- [ ] Learning path system
- [ ] Analytics tracking
- [ ] Looker Studio integration
- [ ] Performance optimization

#### Phase 5: Testing & Deployment (Weeks 9-10)
- [ ] End-to-end testing
- [ ] Production deployment
- [ ] Performance monitoring
- [ ] Documentation completion

### ğŸ¯ Best Practices & Standards

#### Code Quality
- **Linting**: ESLint (Next.js), Flutter analyze (Flutter), Checkstyle (Spring Boot)
- **Testing**: Jest + Testing Library (Next.js), Widget testing (Flutter), JUnit (Spring Boot)
- **Type Safety**: TypeScript (Next.js), Dart (Flutter), Java vá»›i validation annotations

#### Security
- **Authentication**: JWT tokens vá»›i expiration, refresh token rotation
- **Authorization**: Role-based access control (RBAC)
- **Data Validation**: Input sanitization, SQL injection prevention
- **CORS**: Proper cross-origin resource sharing configuration

#### Performance
- **Caching**: Redis cho session, client-side caching cho React queries
- **Database**: Indexing, connection pooling, query optimization
- **CDN**: Firebase Storage hoáº·c CloudFront cho static assets
- **Monitoring**: Application logs, performance metrics

-----

**LÆ¯U Ã QUAN TRá»ŒNG:** **HÃ£y sá»­ dá»¥ng tiáº¿ng Viá»‡t trong má»—i láº§n giáº£i thÃ­ch hoáº·c hÆ°á»›ng dáº«n tá»« AI Agent.**